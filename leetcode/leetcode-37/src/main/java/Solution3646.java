import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Objects;

public class Solution3646 {
    static class V1 {
//        static List<Long> pal;
//
//        static {
//            pal = new ArrayList<>();
//            for (int L = 1; L <= 8; L++) {
//                int low = (int) Math.pow(10, L - 1);
//                int high = (int) Math.pow(10, L);
//                // Check for odd-length palindromes
//                for (int root = low; root < high; root++) {
//                    long p = root;
//                    for (int x = root / 10; x > 0; x /= 10) {
//                        p = p * 10 + x % 10;
//                    }
//                    if (check(p)) pal.add(p);
//                }
//                // Check for even-length palindromes
//                for (int root = low; root < high; root++) {
//                    long p = root;
//                    for (int x = root; x > 0; x /= 10) {
//                        p = p * 10 + x % 10;
//                    }
//                    if (check(p)) pal.add(p);
//                }
//            }
//            pal.sort(null);
//        }
//
//        static boolean check(long n) {
//            Map<Integer, Integer> cnt = new HashMap<>();
//            for (long x = n; x > 0; x /= 10) {
//                int d = (int) (x % 10);
//                if (cnt.merge(d, 1, Integer::sum) > d) return false;
//            }
//            for (Map.Entry<Integer, Integer> entry : cnt.entrySet()) {
//                if (!Objects.equals(entry.getKey(), entry.getValue())) return false;
//            }
//            return true;
//        }
//
//        public static void main(String[] args) {
//            System.out.println(pal);
//            System.out.println(pal.size());
//            System.out.println(A.length);
//        }

        private static final long[] A = {1L, 22L, 212L, 333L, 4444L, 23332L, 32323L, 44144L, 55555L, 244442L, 424424L, 442244L, 666666L, 2441442L, 2555552L, 3443443L, 4241424L, 4343434L, 4421244L, 4433344L, 5255525L, 5525255L, 6661666L, 7777777L, 26666662L, 62666626L, 66266266L, 66622666L, 88888888L, 234434432L, 243434342L, 244333442L, 266616662L, 277777772L, 324434423L, 342434243L, 344232443L, 366636663L, 423434324L, 424333424L, 432434234L, 434232434L, 442333244L, 443232344L, 445555544L, 454555454L, 455454554L, 544555445L, 545454545L, 554454455L, 626616626L, 636636636L, 662616266L, 663636366L, 666212666L, 666333666L, 727777727L, 772777277L, 777272777L, 888818888L, 999999999L, 2888888882L, 4466666644L, 4646666464L, 4664664664L, 4666446664L, 6446666446L, 6464664646L, 6466446646L, 6644664466L, 6646446466L, 6664444666L, 8288888828L, 8828888288L, 8882882888L, 8888228888L, 23666366632L, 24455555442L, 24545554542L, 24554545542L, 25445554452L, 25454545452L, 25544544552L, 26366366362L, 26636363662L, 26663336662L, 28888188882L, 29999999992L, 32666366623L, 36266366263L, 36626362663L, 36662326663L, 38888388883L, 42455555424L, 42545554524L, 42554545524L, 44255555244L, 44525552544L, 44552525544L, 44666166644L, 44777777744L, 45245554254L, 45254545254L, 45425552454L, 45452525454L, 45524542554L, 45542524554L, 46466166464L, 46646164664L, 46664146664L, 47477777474L, 47747774774L, 47774747774L, 52445554425L, 52454545425L, 52544544525L, 54245554245L, 54254545245L, 54425552445L, 54452525445L, 54524542545L, 54542524545L, 55244544255L, 55424542455L, 55442524455L, 55666566655L, 56566566565L, 56656565665L, 56665556665L, 62366366326L, 62636363626L, 62663336626L, 63266366236L, 63626362636L, 63662326636L, 64466166446L, 64646164646L, 64664146646L, 65566566556L, 65656565656L, 65665556656L, 66236363266L, 66263336266L, 66326362366L, 66362326366L, 66446164466L, 66464146466L, 66556565566L, 66565556566L, 66623332666L, 66632323666L, 66644144666L, 66655555666L, 74477777447L, 74747774747L, 74774747747L, 77447774477L, 77474747477L, 77744744777L, 82888188828L, 83888388838L, 88288188288L, 88388388388L, 88828182888L, 88838383888L, 88882128888L, 88883338888L, 92999999929L, 99299999299L, 99929992999L, 99992929999L, 244666666442L, 246466664642L, 246646646642L, 246664466642L, 264466664462L, 264646646462L, 264664466462L, 266446644662L, 266464464662L, 266644446662L, 424666666424L, 426466664624L, 426646646624L, 426664466624L, 442666666244L, 446266662644L, 446626626644L, 446662266644L, 448888888844L, 462466664264L, 462646646264L, 462664466264L, 464266662464L, 464626626464L, 464662266464L, 466246642664L, 466264462664L, 466426624664L, 466462264664L, 466624426664L, 466642246664L, 484888888484L, 488488884884L, 488848848884L, 488884488884L, 624466664426L, 624646646426L, 624664466426L, 626446644626L, 626464464626L, 626644446626L, 642466664246L, 642646646246L, 642664466246L, 644266662446L, 644626626446L, 644662266446L, 646246642646L, 646264462646L, 646426624646L, 646462264646L, 646624426646L, 646642246646L, 662446644266L, 662464464266L, 662644446266L, 664246642466L, 664264462466L, 664426624466L, 664462264466L, 664624426466L, 664642246466L, 666244442666L, 666424424666L, 666442244666L, 844888888448L, 848488884848L, 848848848848L, 848884488848L, 884488884488L, 884848848488L, 884884488488L, 888448844888L, 888484484888L, 888844448888L, 2388883888832L, 2446661666442L, 2447777777442L, 2464661664642L, 2466461646642L, 2466641466642L, 2474777774742L, 2477477747742L, 2477747477742L, 2556665666552L, 2565665665652L, 2566565656652L, 2566655566652L, 2644661664462L, 2646461646462L, 2646641466462L, 2655665665562L, 2656565656562L, 2656655566562L, 2664461644662L, 2664641464662L, 2665565655662L, 2665655565662L, 2666441446662L, 2666555556662L, 2744777774472L, 2747477747472L, 2747747477472L, 2774477744772L, 2774747474772L, 2777447447772L, 2838883888382L, 2883883883882L, 2888383838882L, 2888833388882L, 3288883888823L, 3446663666443L, 3464663664643L, 3466463646643L, 3466643466643L, 3644663664463L, 3646463646463L, 3646643466463L, 3664463644663L, 3664643464663L, 3666443446663L, 3828883888283L, 3882883882883L, 3888283828883L, 3888823288883L, 4246661666424L, 4247777777424L, 4264661664624L, 4266461646624L, 4266641466624L, 4274777774724L, 4277477747724L, 4277747477724L, 4346663666434L, 4364663664634L, 4366463646634L, 4366643466634L, 4426661666244L, 4427777777244L, 4436663666344L, 4462661662644L, 4463663663644L, 4466261626644L, 4466363636644L, 4466621266644L, 4466633366644L, 4472777772744L, 4477277727744L, 4477727277744L, 4488881888844L, 4499999999944L, 4624661664264L, 4626461646264L, 4626641466264L, 4634663664364L, 4636463646364L, 4636643466364L, 4642661662464L, 4643663663464L, 4646261626464L, 4646363636464L, 4646621266464L, 4646633366464L, 4662461642664L, 4662641462664L, 4663463643664L, 4663643463664L, 4664261624664L, 4664363634664L, 4664621264664L, 4664633364664L, 4666241426664L, 4666343436664L, 4666421246664L, 4666433346664L, 4724777774274L, 4727477747274L, 4727747477274L, 4742777772474L, 4747277727474L, 4747727277474L, 4772477742774L, 4772747472774L, 4774277724774L, 4774727274774L, 4777247427774L, 4777427247774L, 4848881888484L, 4884881884884L, 4888481848884L, 4888841488884L, 4949999999494L, 4994999994994L, 4999499949994L, 4999949499994L, 5256665666525L, 5265665665625L, 5266565656625L, 5266655566625L, 5526665666255L, 5562665662655L, 5566265626655L, 5566625266655L, 5588885888855L, 5625665665265L, 5626565656265L, 5626655566265L, 5652665662565L, 5656265626565L, 5656625266565L, 5662565652665L, 5662655562665L, 5665265625665L, 5665625265665L, 5666255526665L, 5666525256665L, 5858885888585L, 5885885885885L, 5888585858885L, 5888855588885L, 6244661664426L, 6246461646426L, 6246641466426L, 6255665665526L, 6256565656526L, 6256655566526L, 6264461644626L, 6264641464626L, 6265565655626L, 6265655565626L, 6266441446626L, 6266555556626L, 6344663664436L, 6346463646436L, 6346643466436L, 6364463644636L, 6364643464636L, 6366443446636L, 6424661664246L, 6426461646246L, 6426641466246L, 6434663664346L, 6436463646346L, 6436643466346L, 6442661662446L, 6443663663446L, 6446261626446L, 6446363636446L, 6446621266446L, 6446633366446L, 6462461642646L, 6462641462646L, 6463463643646L, 6463643463646L, 6464261624646L, 6464363634646L, 6464621264646L, 6464633364646L, 6466241426646L, 6466343436646L, 6466421246646L, 6466433346646L, 6525665665256L, 6526565656256L, 6526655566256L, 6552665662556L, 6556265626556L, 6556625266556L, 6562565652656L, 6562655562656L, 6565265625656L, 6565625265656L, 6566255526656L, 6566525256656L, 6624461644266L, 6624641464266L, 6625565655266L, 6625655565266L, 6626441446266L, 6626555556266L, 6634463644366L, 6634643464366L, 6636443446366L, 6642461642466L, 6642641462466L, 6643463643466L, 6643643463466L, 6644261624466L, 6644363634466L, 6644621264466L, 6644633364466L, 6646241426466L, 6646343436466L, 6646421246466L, 6646433346466L, 6652565652566L, 6652655562566L, 6655265625566L, 6655625265566L, 6656255526566L, 6656525256566L, 6662441442666L, 6662555552666L, 6663443443666L, 6664241424666L, 6664343434666L, 6664421244666L, 6664433344666L, 6665255525666L, 6665525255666L, 6667777777666L, 6676777776766L, 6677677767766L, 6677767677766L, 6766777776676L, 6767677767676L, 6767767677676L, 6776677766776L, 6776767676776L, 6777667667776L, 7244777774427L, 7247477747427L, 7247747477427L, 7274477744727L, 7274747474727L, 7277447447727L, 7424777774247L, 7427477747247L, 7427747477247L, 7442777772447L, 7447277727447L, 7447727277447L, 7472477742747L, 7472747472747L, 7474277724747L, 7474727274747L, 7477247427747L, 7477427247747L, 7666777776667L, 7667677767667L, 7667767677667L, 7676677766767L, 7676767676767L, 7677667667767L, 7724477744277L, 7724747474277L, 7727447447277L, 7742477742477L, 7742747472477L, 7744277724477L, 7744727274477L, 7747247427477L, 7747427247477L, 7766677766677L, 7766767676677L, 7767667667677L, 7772447442777L, 7774247424777L, 7774427244777L, 7776667666777L, 8238883888328L, 8283883883828L, 8288383838828L, 8288833388828L, 8328883888238L, 8382883882838L, 8388283828838L, 8388823288838L, 8448881888448L, 8484881884848L, 8488481848848L, 8488841488848L, 8558885888558L, 8585885885858L, 8588585858858L, 8588855588858L, 8823883883288L, 8828383838288L, 8828833388288L, 8832883882388L, 8838283828388L, 8838823288388L, 8844881884488L, 8848481848488L, 8848841488488L, 8855885885588L, 8858585858588L, 8858855588588L, 8882383832888L, 8882833382888L, 8883283823888L, 8883823283888L, 8884481844888L, 8884841484888L, 8885585855888L, 8885855585888L, 8888233328888L, 8888323238888L, 8888441448888L, 8888555558888L, 9449999999449L, 9494999994949L, 9499499949949L, 9499949499949L, 9944999994499L, 9949499949499L, 9949949499499L, 9994499944999L, 9994949494999L, 9999449449999L, 24488888888442L, 24848888884842L, 24884888848842L, 24888488488842L, 24888844888842L, 28448888884482L, 28484888848482L, 28488488488482L, 28488844888482L, 28844888844882L, 28848488484882L, 28848844884882L, 28884488448882L, 28884844848882L, 28888444488882L, 42488888888424L, 42848888884824L, 42884888848824L, 42888488488824L, 42888844888824L, 44288888888244L, 44828888882844L, 44882888828844L, 44888288288844L, 44888822888844L, 48248888884284L, 48284888848284L, 48288488488284L, 48288844888284L, 48428888882484L, 48482888828484L, 48488288288484L, 48488822888484L, 48824888842884L, 48828488482884L, 48828844882884L, 48842888824884L, 48848288284884L, 48848822884884L, 48882488428884L, 48882844828884L, 48884288248884L, 48884822848884L, 48888244288884L, 48888422488884L, 66688888888666L, 66868888886866L, 66886888868866L, 66888688688866L, 66888866888866L, 68668888886686L, 68686888868686L, 68688688688686L, 68688866888686L, 68866888866886L, 68868688686886L, 68868866886886L, 68886688668886L, 68886866868886L, 68888666688886L, 82448888884428L, 82484888848428L, 82488488488428L, 82488844888428L, 82844888844828L, 82848488484828L, 82848844884828L, 82884488448828L, 82884844848828L, 82888444488828L, 84248888884248L, 84284888848248L, 84288488488248L, 84288844888248L, 84428888882448L, 84482888828448L, 84488288288448L, 84488822888448L, 84824888842848L, 84828488482848L, 84828844882848L, 84842888824848L, 84848288284848L, 84848822884848L, 84882488428848L, 84882844828848L, 84884288248848L, 84884822848848L, 84888244288848L, 84888422488848L, 86668888886668L, 86686888868668L, 86688688688668L, 86688866888668L, 86866888866868L, 86868688686868L, 86868866886868L, 86886688668868L, 86886866868868L, 86888666688868L, 88244888844288L, 88248488484288L, 88248844884288L, 88284488448288L, 88284844848288L, 88288444488288L, 88424888842488L, 88428488482488L, 88428844882488L, 88442888824488L, 88448288284488L, 88448822884488L, 88482488428488L, 88482844828488L, 88484288248488L, 88484822848488L, 88488244288488L, 88488422488488L, 88666888866688L, 88668688686688L, 88668866886688L, 88686688668688L, 88686866868688L, 88688666688688L, 88824488442888L, 88824844842888L, 88828444482888L, 88842488424888L, 88842844824888L, 88844288244888L, 88844822844888L, 88848244284888L, 88848422484888L, 88866688666888L, 88866866866888L, 88868666686888L, 88882444428888L, 88884244248888L, 88884422448888L, 88886666668888L, 234466636664432L, 234646636646432L, 234664636466432L, 234666434666432L, 236446636644632L, 236464636464632L, 236466434664632L, 236644636446632L, 236646434646632L, 236664434466632L, 243466636664342L, 243646636646342L, 243664636466342L, 243666434666342L, 244366636663442L, 244636636636442L, 244663636366442L, 244666333666442L, 244888818888442L, 244999999999442L, 246346636643642L, 246364636463642L, 246366434663642L, 246436636634642L, 246463636364642L, 246466333664642L, 246634636436642L, 246636434636642L, 246643636346642L, 246646333646642L, 246663434366642L, 246664333466642L, 248488818884842L, 248848818848842L, 248884818488842L, 248888414888842L, 249499999994942L, 249949999949942L, 249994999499942L, 249999494999942L, 255888858888552L, 258588858885852L, 258858858858852L, 258885858588852L, 258888555888852L, 263446636644362L, 263464636464362L, 263466434664362L, 263644636446362L, 263646434646362L, 263664434466362L, 264346636643462L, 264364636463462L, 264366434663462L, 264436636634462L, 264463636364462L, 264466333664462L, 264634636436462L, 264636434636462L, 264643636346462L, 264646333646462L, 264663434366462L, 264664333466462L, 266344636443662L, 266346434643662L, 266364434463662L, 266434636434662L, 266436434634662L, 266443636344662L, 266446333644662L, 266463434364662L, 266464333464662L, 266634434436662L, 266643434346662L, 266644333446662L, 266677777776662L, 266767777767662L, 266776777677662L, 266777676777662L, 267667777766762L, 267676777676762L, 267677676776762L, 267766777667762L, 267767676767762L, 267776676677762L, 276667777766672L, 276676777676672L, 276677676776672L, 276766777667672L, 276767676767672L, 276776676677672L, 277666777666772L, 277667676766772L, 277676676676772L, 277766676667772L, 284488818884482L, 284848818848482L, 284884818488482L, 284888414888482L, 285588858885582L, 285858858858582L, 285885858588582L, 285888555888582L, 288448818844882L, 288484818484882L, 288488414884882L, 288558858855882L, 288585858585882L, 288588555885882L, 288844818448882L, 288848414848882L, 288855858558882L, 288858555858882L, 288884414488882L, 288885555588882L, 294499999994492L, 294949999949492L, 294994999499492L, 294999494999492L, 299449999944992L, 299494999494992L, 299499494994992L, 299944999449992L, 299949494949992L, 299994494499992L, 324466636664423L, 324646636646423L, 324664636466423L, 324666434666423L, 326446636644623L, 326464636464623L, 326466434664623L, 326644636446623L, 326646434646623L, 326664434466623L, 342466636664243L, 342646636646243L, 342664636466243L, 342666434666243L, 344266636662443L, 344626636626443L, 344662636266443L, 344666232666443L, 344888838888443L, 346246636642643L, 346264636462643L, 346266434662643L, 346426636624643L, 346462636264643L, 346466232664643L, 346624636426643L, 346626434626643L, 346642636246643L, 346646232646643L, 346662434266643L, 346664232466643L, 348488838884843L, 348848838848843L, 348884838488843L, 348888434888843L, 362446636644263L, 362464636464263L, 362466434664263L, 362644636446263L, 362646434646263L, 362664434466263L, 364246636642463L, 364264636462463L, 364266434662463L, 364426636624463L, 364462636264463L, 364466232664463L, 364624636426463L, 364626434626463L, 364642636246463L, 364646232646463L, 364662434266463L, 364664232466463L, 366244636442663L, 366246434642663L, 366264434462663L, 366424636424663L, 366426434624663L, 366442636244663L, 366446232644663L, 366462434264663L, 366464232464663L, 366624434426663L, 366642434246663L, 366644232446663L, 384488838884483L, 384848838848483L, 384884838488483L, 384888434888483L, 388448838844883L, 388484838484883L, 388488434884883L, 388844838448883L, 388848434848883L, 388884434488883L, 423466636664324L, 423646636646324L, 423664636466324L, 423666434666324L, 424366636663424L, 424636636636424L, 424663636366424L, 424666333666424L, 424888818888424L, 424999999999424L, 426346636643624L, 426364636463624L, 426366434663624L, 426436636634624L, 426463636364624L, 426466333664624L, 426634636436624L, 426636434636624L, 426643636346624L, 426646333646624L, 426663434366624L, 426664333466624L, 428488818884824L, 428848818848824L, 428884818488824L, 428888414888824L, 429499999994924L, 429949999949924L, 429994999499924L, 429999494999924L, 432466636664234L, 432646636646234L, 432664636466234L, 432666434666234L, 434266636662434L, 434626636626434L, 434662636266434L, 434666232666434L, 434888838888434L, 436246636642634L, 436264636462634L, 436266434662634L, 436426636624634L, 436462636264634L, 436466232664634L, 436624636426634L, 436626434626634L, 436642636246634L, 436646232646634L, 436662434266634L, 436664232466634L, 438488838884834L, 438848838848834L, 438884838488834L, 438888434888834L, 442366636663244L, 442636636636244L, 442663636366244L, 442666333666244L, 442888818888244L, 442999999999244L, 443266636662344L, 443626636626344L, 443662636266344L, 443666232666344L, 443888838888344L, 445566656665544L, 445656656656544L, 445665656566544L, 445666555666544L, 446236636632644L, 446263636362644L, 446266333662644L, 446326636623644L, 446362636263644L, 446366232663644L, 446556656655644L, 446565656565644L, 446566555665644L, 446623636326644L, 446626333626644L, 446632636236644L, 446636232636644L, 446655656556644L, 446656555656644L, 446662333266644L, 446663232366644L, 446665555566644L, 448288818882844L, 448388838883844L, 448828818828844L, 448838838838844L, 448882818288844L, 448883838388844L, 448888212888844L, 448888333888844L, 449299999992944L, 449929999929944L, 449992999299944L, 449999292999944L, 454566656665454L, 454656656656454L, 454665656566454L, 454666555666454L, 455466656664554L, 455646656646554L, 455664656466554L, 455666454666554L, 456456656654654L, 456465656564654L, 456466555664654L, 456546656645654L, 456564656465654L, 456566454665654L, 456645656546654L, 456646555646654L, 456654656456654L, 456656454656654L, 456664555466654L, 456665454566654L, 462346636643264L, 462364636463264L, 462366434663264L, 462436636634264L, 462463636364264L, 462466333664264L, 462634636436264L, 462636434636264L, 462643636346264L, 462646333646264L, 462663434366264L, 462664333466264L, 463246636642364L, 463264636462364L, 463266434662364L, 463426636624364L, 463462636264364L, 463466232664364L, 463624636426364L, 463626434626364L, 463642636246364L, 463646232646364L, 463662434266364L, 463664232466364L, 464236636632464L, 464263636362464L, 464266333662464L, 464326636623464L, 464362636263464L, 464366232663464L, 464556656655464L, 464565656565464L, 464566555665464L, 464623636326464L, 464626333626464L, 464632636236464L, 464636232636464L, 464655656556464L, 464656555656464L, 464662333266464L, 464663232366464L, 464665555566464L, 465456656654564L, 465465656564564L, 465466555664564L, 465546656645564L, 465564656465564L, 465566454665564L, 465645656546564L, 465646555646564L, 465654656456564L, 465656454656564L, 465664555466564L, 465665454566564L, 466234636432664L, 466236434632664L, 466243636342664L, 466246333642664L, 466263434362664L, 466264333462664L, 466324636423664L, 466326434623664L, 466342636243664L, 466346232643664L, 466362434263664L, 466364232463664L, 466423636324664L, 466426333624664L, 466432636234664L, 466436232634664L, 466455656554664L, 466456555654664L, 466462333264664L, 466463232364664L, 466465555564664L, 466545656545664L, 466546555645664L, 466554656455664L, 466556454655664L, 466564555465664L, 466565454565664L, 466623434326664L, 466624333426664L, 466632434236664L, 466634232436664L, 466642333246664L, 466643232346664L, 466645555546664L, 466654555456664L, 466655454556664L, 482488818884284L, 482848818848284L, 482884818488284L, 482888414888284L, 483488838884384L, 483848838848384L, 483884838488384L, 483888434888384L, 484288818882484L, 484388838883484L, 484828818828484L, 484838838838484L, 484882818288484L, 484883838388484L, 484888212888484L, 484888333888484L, 488248818842884L, 488284818482884L, 488288414882884L, 488348838843884L, 488384838483884L, 488388434883884L, 488428818824884L, 488438838834884L, 488482818284884L, 488483838384884L, 488488212884884L, 488488333884884L, 488824818428884L, 488828414828884L, 488834838438884L, 488838434838884L, 488842818248884L, 488843838348884L, 488848212848884L, 488848333848884L, 488882414288884L, 488883434388884L, 488884212488884L, 488884333488884L, 492499999994294L, 492949999949294L, 492994999499294L, 492999494999294L, 494299999992494L, 494929999929494L, 494992999299494L, 494999292999494L, 499249999942994L, 499294999492994L, 499299494992994L, 499429999924994L, 499492999294994L, 499499292994994L, 499924999429994L, 499929494929994L, 499942999249994L, 499949292949994L, 499992494299994L, 499994292499994L, 525888858888525L, 528588858885825L, 528858858858825L, 528885858588825L, 528888555888825L, 544566656665445L, 544656656656445L, 544665656566445L, 544666555666445L, 545466656664545L, 545646656646545L, 545664656466545L, 545666454666545L, 546456656654645L, 546465656564645L, 546466555664645L, 546546656645645L, 546564656465645L, 546566454665645L, 546645656546645L, 546646555646645L, 546654656456645L, 546656454656645L, 546664555466645L, 546665454566645L, 552888858888255L, 554466656664455L, 554646656646455L, 554664656466455L, 554666454666455L, 556446656644655L, 556464656464655L, 556466454664655L, 556644656446655L, 556646454646655L, 556664454466655L, 558288858882855L, 558828858828855L, 558882858288855L, 558888252888855L, 564456656654465L, 564465656564465L, 564466555664465L, 564546656645465L, 564564656465465L, 564566454665465L, 564645656546465L, 564646555646465L, 564654656456465L, 564656454656465L, 564664555466465L, 564665454566465L, 565446656644565L, 565464656464565L, 565466454664565L, 565644656446565L, 565646454646565L, 565664454466565L, 566445656544665L, 566446555644665L, 566454656454665L, 566456454654665L, 566464555464665L, 566465454564665L, 566544656445665L, 566546454645665L, 566564454465665L, 566644555446665L, 566645454546665L, 566654454456665L, 582588858885285L, 582858858858285L, 582885858588285L, 582888555888285L, 585288858882585L, 585828858828585L, 585882858288585L, 585888252888585L, 588258858852885L, 588285858582885L, 588288555882885L, 588528858825885L, 588582858285885L, 588588252885885L, 588825858528885L, 588828555828885L, 588852858258885L, 588858252858885L, 588882555288885L, 588885252588885L, 623446636644326L, 623464636464326L, 623466434664326L, 623644636446326L, 623646434646326L, 623664434466326L, 624346636643426L, 624364636463426L, 624366434663426L, 624436636634426L, 624463636364426L, 624466333664426L, 624634636436426L, 624636434636426L, 624643636346426L, 624646333646426L, 624663434366426L, 624664333466426L, 626344636443626L, 626346434643626L, 626364434463626L, 626434636434626L, 626436434634626L, 626443636344626L, 626446333644626L, 626463434364626L, 626464333464626L, 626634434436626L, 626643434346626L, 626644333446626L, 626677777776626L, 626767777767626L, 626776777677626L, 626777676777626L, 627667777766726L, 627676777676726L, 627677676776726L, 627766777667726L, 627767676767726L, 627776676677726L, 632446636644236L, 632464636464236L, 632466434664236L, 632644636446236L, 632646434646236L, 632664434466236L, 634246636642436L, 634264636462436L, 634266434662436L, 634426636624436L, 634462636264436L, 634466232664436L, 634624636426436L, 634626434626436L, 634642636246436L, 634646232646436L, 634662434266436L, 634664232466436L, 636244636442636L, 636246434642636L, 636264434462636L, 636424636424636L, 636426434624636L, 636442636244636L, 636446232644636L, 636462434264636L, 636464232464636L, 636624434426636L, 636642434246636L, 636644232446636L, 642346636643246L, 642364636463246L, 642366434663246L, 642436636634246L, 642463636364246L, 642466333664246L, 642634636436246L, 642636434636246L, 642643636346246L, 642646333646246L, 642663434366246L, 642664333466246L, 643246636642346L, 643264636462346L, 643266434662346L, 643426636624346L, 643462636264346L, 643466232664346L, 643624636426346L, 643626434626346L, 643642636246346L, 643646232646346L, 643662434266346L, 643664232466346L, 644236636632446L, 644263636362446L, 644266333662446L, 644326636623446L, 644362636263446L, 644366232663446L, 644556656655446L, 644565656565446L, 644566555665446L, 644623636326446L, 644626333626446L, 644632636236446L, 644636232636446L, 644655656556446L, 644656555656446L, 644662333266446L, 644663232366446L, 644665555566446L, 645456656654546L, 645465656564546L, 645466555664546L, 645546656645546L, 645564656465546L, 645566454665546L, 645645656546546L, 645646555646546L, 645654656456546L, 645656454656546L, 645664555466546L, 645665454566546L, 646234636432646L, 646236434632646L, 646243636342646L, 646246333642646L, 646263434362646L, 646264333462646L, 646324636423646L, 646326434623646L, 646342636243646L, 646346232643646L, 646362434263646L, 646364232463646L, 646423636324646L, 646426333624646L, 646432636234646L, 646436232634646L, 646455656554646L, 646456555654646L, 646462333264646L, 646463232364646L, 646465555564646L, 646545656545646L, 646546555645646L, 646554656455646L, 646556454655646L, 646564555465646L, 646565454565646L, 646623434326646L, 646624333426646L, 646632434236646L, 646634232436646L, 646642333246646L, 646643232346646L, 646645555546646L, 646654555456646L, 646655454556646L, 654456656654456L, 654465656564456L, 654466555664456L, 654546656645456L, 654564656465456L, 654566454665456L, 654645656546456L, 654646555646456L, 654654656456456L, 654656454656456L, 654664555466456L, 654665454566456L, 655446656644556L, 655464656464556L, 655466454664556L, 655644656446556L, 655646454646556L, 655664454466556L, 656445656544656L, 656446555644656L, 656454656454656L, 656456454654656L, 656464555464656L, 656465454564656L, 656544656445656L, 656546454645656L, 656564454465656L, 656644555446656L, 656645454546656L, 656654454456656L, 662344636443266L, 662346434643266L, 662364434463266L, 662434636434266L, 662436434634266L, 662443636344266L, 662446333644266L, 662463434364266L, 662464333464266L, 662634434436266L, 662643434346266L, 662644333446266L, 662677777776266L, 662767777767266L, 662776777677266L, 662777676777266L, 663244636442366L, 663246434642366L, 663264434462366L, 663424636424366L, 663426434624366L, 663442636244366L, 663446232644366L, 663462434264366L, 663464232464366L, 663624434426366L, 663642434246366L, 663644232446366L, 664234636432466L, 664236434632466L, 664243636342466L, 664246333642466L, 664263434362466L, 664264333462466L, 664324636423466L, 664326434623466L, 664342636243466L, 664346232643466L, 664362434263466L, 664364232463466L, 664423636324466L, 664426333624466L, 664432636234466L, 664436232634466L, 664455656554466L, 664456555654466L, 664462333264466L, 664463232364466L, 664465555564466L, 664545656545466L, 664546555645466L, 664554656455466L, 664556454655466L, 664564555465466L, 664565454565466L, 664623434326466L, 664624333426466L, 664632434236466L, 664634232436466L, 664642333246466L, 664643232346466L, 664645555546466L, 664654555456466L, 664655454556466L, 665445656544566L, 665446555644566L, 665454656454566L, 665456454654566L, 665464555464566L, 665465454564566L, 665544656445566L, 665546454645566L, 665564454465566L, 665644555446566L, 665645454546566L, 665654454456566L, 666234434432666L, 666243434342666L, 666244333442666L, 666277777772666L, 666324434423666L, 666342434243666L, 666344232443666L, 666423434324666L, 666424333424666L, 666432434234666L, 666434232434666L, 666442333244666L, 666443232344666L, 666445555544666L, 666454555454666L, 666455454554666L, 666544555445666L, 666545454545666L, 666554454455666L, 666727777727666L, 666772777277666L, 666777272777666L, 666888818888666L, 666999999999666L, 667267777762766L, 667276777672766L, 667277676772766L, 667627777726766L, 667672777276766L, 667677272776766L, 667726777627766L, 667727676727766L, 667762777267766L, 667767272767766L, 667772676277766L, 667776272677766L, 668688818886866L, 668868818868866L, 668886818688866L, 668888616888866L, 669699999996966L, 669969999969966L, 669996999699966L, 669999696999966L, 672667777766276L, 672676777676276L, 672677676776276L, 672766777667276L, 672767676767276L, 672776676677276L, 676267777762676L, 676276777672676L, 676277676772676L, 676627777726676L, 676672777276676L, 676677272776676L, 676726777627676L, 676727676727676L, 676762777267676L, 676767272767676L, 676772676277676L, 676776272677676L, 677266777662776L, 677267676762776L, 677276676672776L, 677626777626776L, 677627676726776L, 677662777266776L, 677667272766776L, 677672676276776L, 677676272676776L, 677726676627776L, 677762676267776L, 677766272667776L, 686688818886686L, 686868818868686L, 686886818688686L, 686888616888686L, 688668818866886L, 688686818686886L, 688688616886886L, 688866818668886L, 688868616868886L, 688886616688886L, 696699999996696L, 696969999969696L, 696996999699696L, 696999696999696L, 699669999966996L, 699696999696996L, 699699696996996L, 699966999669996L, 699969696969996L, 699996696699996L, 726667777766627L, 726676777676627L, 726677676776627L, 726766777667627L, 726767676767627L, 726776676677627L, 727666777666727L, 727667676766727L, 727676676676727L, 727766676667727L, 762667777766267L, 762676777676267L, 762677676776267L, 762766777667267L, 762767676767267L, 762776676677267L, 766267777762667L, 766276777672667L, 766277676772667L, 766627777726667L, 766672777276667L, 766677272776667L, 766726777627667L, 766727676727667L, 766762777267667L, 766767272767667L, 766772676277667L, 766776272677667L, 767266777662767L, 767267676762767L, 767276676672767L, 767626777626767L, 767627676726767L, 767662777266767L, 767667272766767L, 767672676276767L, 767676272676767L, 767726676627767L, 767762676267767L, 767766272667767L, 772666777666277L, 772667676766277L, 772676676676277L, 772766676667277L, 776266777662677L, 776267676762677L, 776276676672677L, 776626777626677L, 776627676726677L, 776662777266677L, 776667272766677L, 776672676276677L, 776676272676677L, 776726676627677L, 776762676267677L, 776766272667677L, 777266676662777L, 777626676626777L, 777662676266777L, 777666272666777L, 777888878888777L, 778788878887877L, 778878878878877L, 778887878788877L, 778888777888877L, 787788878887787L, 787878878878787L, 787887878788787L, 787888777888787L, 788778878877887L, 788787878787887L, 788788777887887L, 788877878778887L, 788878777878887L, 788887777788887L, 824488818884428L, 824848818848428L, 824884818488428L, 824888414888428L, 825588858885528L, 825858858858528L, 825885858588528L, 825888555888528L, 828448818844828L, 828484818484828L, 828488414884828L, 828558858855828L, 828585858585828L, 828588555885828L, 828844818448828L, 828848414848828L, 828855858558828L, 828858555858828L, 828884414488828L, 828885555588828L, 834488838884438L, 834848838848438L, 834884838488438L, 834888434888438L, 838448838844838L, 838484838484838L, 838488434884838L, 838844838448838L, 838848434848838L, 838884434488838L, 842488818884248L, 842848818848248L, 842884818488248L, 842888414888248L, 843488838884348L, 843848838848348L, 843884838488348L, 843888434888348L, 844288818882448L, 844388838883448L, 844828818828448L, 844838838838448L, 844882818288448L, 844883838388448L, 844888212888448L, 844888333888448L, 848248818842848L, 848284818482848L, 848288414882848L, 848348838843848L, 848384838483848L, 848388434883848L, 848428818824848L, 848438838834848L, 848482818284848L, 848483838384848L, 848488212884848L, 848488333884848L, 848824818428848L, 848828414828848L, 848834838438848L, 848838434838848L, 848842818248848L, 848843838348848L, 848848212848848L, 848848333848848L, 848882414288848L, 848883434388848L, 848884212488848L, 848884333488848L, 852588858885258L, 852858858858258L, 852885858588258L, 852888555888258L, 855288858882558L, 855828858828558L, 855882858288558L, 855888252888558L, 858258858852858L, 858285858582858L, 858288555882858L, 858528858825858L, 858582858285858L, 858588252885858L, 858825858528858L, 858828555828858L, 858852858258858L, 858858252858858L, 858882555288858L, 858885252588858L, 866688818886668L, 866868818868668L, 866886818688668L, 866888616888668L, 868668818866868L, 868686818686868L, 868688616886868L, 868866818668868L, 868868616868868L, 868886616688868L, 877788878887778L, 877878878878778L, 877887878788778L, 877888777888778L, 878778878877878L, 878787878787878L, 878788777887878L, 878877878778878L, 878878777878878L, 878887777788878L, 882448818844288L, 882484818484288L, 882488414884288L, 882558858855288L, 882585858585288L, 882588555885288L, 882844818448288L, 882848414848288L, 882855858558288L, 882858555858288L, 882884414488288L, 882885555588288L, 883448838844388L, 883484838484388L, 883488434884388L, 883844838448388L, 883848434848388L, 883884434488388L, 884248818842488L, 884284818482488L, 884288414882488L, 884348838843488L, 884384838483488L, 884388434883488L, 884428818824488L, 884438838834488L, 884482818284488L, 884483838384488L, 884488212884488L, 884488333884488L, 884824818428488L, 884828414828488L, 884834838438488L, 884838434838488L, 884842818248488L, 884843838348488L, 884848212848488L, 884848333848488L, 884882414288488L, 884883434388488L, 884884212488488L, 884884333488488L, 885258858852588L, 885285858582588L, 885288555882588L, 885528858825588L, 885582858285588L, 885588252885588L, 885825858528588L, 885828555828588L, 885852858258588L, 885858252858588L, 885882555288588L, 885885252588588L, 886668818866688L, 886686818686688L, 886688616886688L, 886866818668688L, 886868616868688L, 886886616688688L, 887778878877788L, 887787878787788L, 887788777887788L, 887877878778788L, 887878777878788L, 887887777788788L, 888244818442888L, 888248414842888L, 888255858552888L, 888258555852888L, 888284414482888L, 888285555582888L, 888344838443888L, 888348434843888L, 888384434483888L, 888424818424888L, 888428414824888L, 888434838434888L, 888438434834888L, 888442818244888L, 888443838344888L, 888448212844888L, 888448333844888L, 888482414284888L, 888483434384888L, 888484212484888L, 888484333484888L, 888525858525888L, 888528555825888L, 888552858255888L, 888558252855888L, 888582555285888L, 888585252585888L, 888666818666888L, 888668616866888L, 888686616686888L, 888777878777888L, 888778777877888L, 888787777787888L, 888824414428888L, 888825555528888L, 888834434438888L, 888842414248888L, 888843434348888L, 888844212448888L, 888844333448888L, 888852555258888L, 888855252558888L, 888866616668888L, 888877777778888L, 924499999994429L, 924949999949429L, 924994999499429L, 924999494999429L, 929449999944929L, 929494999494929L, 929499494994929L, 929944999449929L, 929949494949929L, 929994494499929L, 942499999994249L, 942949999949249L, 942994999499249L, 942999494999249L, 944299999992449L, 944929999929449L, 944992999299449L, 944999292999449L, 949249999942949L, 949294999492949L, 949299494992949L, 949429999924949L, 949492999294949L, 949499292994949L, 949924999429949L, 949929494929949L, 949942999249949L, 949949292949949L, 949992494299949L, 949994292499949L, 966699999996669L, 966969999969669L, 966996999699669L, 966999696999669L, 969669999966969L, 969696999696969L, 969699696996969L, 969966999669969L, 969969696969969L, 969996696699969L, 992449999944299L, 992494999494299L, 992499494994299L, 992944999449299L, 992949494949299L, 992994494499299L, 994249999942499L, 994294999492499L, 994299494992499L, 994429999924499L, 994492999294499L, 994499292994499L, 994924999429499L, 994929494929499L, 994942999249499L, 994949292949499L, 994992494299499L, 994994292499499L, 996669999966699L, 996696999696699L, 996699696996699L, 996966999669699L, 996969696969699L, 996996696699699L, 999244999442999L, 999249494942999L, 999294494492999L, 999424999424999L, 999429494924999L, 999442999244999L, 999449292944999L, 999492494294999L, 999494292494999L, 999666999666999L, 999669696966999L, 999696696696999L, 999924494429999L, 999942494249999L, 999944292449999L, 999966696669999L, 2666888888886662L};

        private int upperBound(long[] a, long key) {
            int l = 0, r = a.length;
            while (l < r) {
                int m = l + (r - l) / 2;
                if (a[m] > key) r = m;
                else l = m + 1;
            }
            return l;
        }

        public long specialPalindrome(long n) {
            return A[upperBound(A, n)];
        }
    }

    // 数位DP Java 版本，可支持 n <= 1e18，可支持 n <= 1e28（需调整至 BigInt 版本）：
    static class V2 {
        private long[] subSum;
        private int[] mp = new int[10];
        private long oddMask;
        private int[] cnt = new int[10];
        private long ans;
        private long num;
        private String s;
        private int n;

        public long specialPalindrome(long Num) {
            num = Num;
            s = String.valueOf(num);
            n = s.length();
            subSum = new long[1 << 9];
            int[] a = new int[]{1, 9, 8, 7, 6, 5, 4, 3, 2};
            oddMask = 0;
            for (int i = 0; i < a.length; i++) {
                int v = a[i];
                mp[v] = i;
                if (v % 2 > 0) {
                    oddMask |= 1 << i;
                }
                int highBit = 1 << i;
                for (int mask = 0; mask < highBit; mask++) {
                    subSum[highBit | mask] = subSum[mask] + v;
                }
            }
            for (int mask = 1; mask < (1 << 9); mask++) {
                long t = mask & oddMask;
                if (t != 0 && (t & (t - 1)) != 0) {
                    subSum[mask] = -1;
                }
            }

            cnt = new int[10];
            ans = 0;
            if (dfs(0, 0, 0, true)) {
                return ans;
            }

            for (int mask = (1 << 9) - 1; mask >= 0; mask--) {
                if (subSum[mask] == n + 1) {
                    return extend(0, mask, 0);
                }
            }
            return 0;
        }

        private long full(long pal, int odd) {
            long v = pal;
            if (odd > 0) {
                pal = pal * 10 + odd;
            }
            while (v > 0) {
                pal = pal * 10 + v % 10;
                v /= 10;
            }
            return pal;
        }

        private long extend(int pal, int mask, int odd) {
            for (int j = 1; j < 10; j++) {
                int need = 0;
                if ((mask >> mp[j] & 1) > 0) {
                    need = j;
                } else if (cnt[j] > 0) {
                    need = j - cnt[j];
                }
                for (int k = 0; k < need / 2; k++) {
                    pal = pal * 10 + j;
                }
                if (need > 0 && j % 2 > 0) {
                    odd = j;
                }
            }
            return full(pal, odd);
        }

        private boolean dfs(int i, int pal, int odd, boolean limit) {
            if (odd > 0 && n % 2 == 0) {
                return false;
            }

            if (i == n / 2) {
                if (n % 2 == 0) {
                    for (int j = 0; j < 10; j++) {
                        if (cnt[j] > 0 && cnt[j] != j) {
                            return false;
                        }
                    }
                    long fullPal = full(pal, 0);
                    if (fullPal > num) {
                        ans = fullPal;
                        return true;
                    }
                    return false;
                } else {
                    if (odd == 0) {
                        odd = 1;
                    }
                    cnt[odd]++;
                    try {
                        for (int j = 0; j < 10; j++) {
                            if (cnt[j] > 0 && cnt[j] != j) {
                                return false;
                            }
                        }
                        long fullPal = full(pal, odd);
                        if (fullPal > num) {
                            ans = fullPal;
                            return true;
                        }
                        return false;
                    } finally {
                        cnt[odd]--;
                    }
                }
            }

            if (!limit) {
                int left = n - i * 2;
                int mask = (1 << 9) - 1;
                for (int j = 0; j < 10; j++) {
                    if (cnt[j] > 0) {
                        left -= j - cnt[j];
                        mask ^= 1 << mp[j];
                    }
                }
                if (left < 0) {
                    return false;
                }

                for (int sub = mask; ; sub = (sub - 1) & mask) {
                    if ((odd == 0 || (sub & oddMask) == 0) && subSum[sub] == left) {
                        ans = extend(pal, sub, odd);
                        return true;
                    }
                    if (sub == 0) {
                        break;
                    }
                }
                return false;
            }

            int low = s.charAt(i) - '0';
            for (int v = low; v <= 9; v++) {
                if (cnt[v] + 2 > v || (odd > 0 && v % 2 > 0 && v != odd)) {
                    continue;
                }
                int newOdd = odd;
                if (v % 2 > 0) {
                    newOdd = v;
                }
                cnt[v] += 2;
                if (dfs(i + 1, pal * 10 + v, newOdd, limit && v == low)) {
                    return true;
                }
                cnt[v] -= 2;
            }
            return false;
        }
    }
}
/*
3646. 下一个特殊回文数
https://leetcode.cn/problems/next-special-palindrome-number/description/

第 462 场周赛 T4。

给你一个整数 n。
- 如果一个数满足以下条件，那么它被称为 特殊数 ：
- 它是一个 回文数 。
数字中每个数字 k 出现 恰好 k 次。
返回 严格 大于 n 的 最小 特殊数。
如果一个整数正向读和反向读都相同，则它是 回文数 。例如，121 是回文数，而 123 不是。
提示:
0 <= n <= 10^15

打表 + 二分。不超过 1e16 并且符合要求的可能回文数只有 2296 个。代码提交时可以精简至 2017 个（大于 1e15 的的一个数是 2666888888886662）。
时间复杂度 O(1)。
rating 2471 (clist.by)
 */